var channels = {
    "WILLOW": {
    file: "https://abefxgoaaaaaaaamnqzfrlp4mja77.otte.live.cf.ww.aiv-cdn.net/iad-nitro/live/clients/dash/enc/e2f54ettz3/out/v1/6314fa93db1641a6b755c4f676cd2f2f/cenc-sd.mpd",
    keyId:"e050e43ab17c115bf8724d72f3fc5ce3",
    key: "02b829742b9cecca87718ccabf5f1482",
    logo: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT9P0oG35eXN9jgXeY9Y-mErVK2ndqKUCj0RJe3dBSb_w&s=10",
  },
  "7 cricket": {
    file: "https://hugh.cdn.rumble.cloud/live/4gf18j5s/slot-41/teed-wyvn_1080p/chunklist.m3u8",
    logo: "https://cdna.artstation.com/p/assets/images/images/068/716/216/large/channel-7-tv-channel-7-tv-stylish-logo.jpg?1698472086",
  },
        "fox cricket": {
    file: "https://hugh.cdn.rumble.cloud/live/u7gf26qm/slot-117/zw23-96or_1080p/chunklist.m3u8",
    logo: "https://images.seeklogo.com/logo-png/61/1/fox-cricket-logo-png_seeklogo-612614.png",
  },
  "WILLOW SPORTS": {
    file: "https://abmyxykaaaaaaaamkyvb65fuqebyg.7a77200bf98444ac997a89ed83775793.emt.cf.ww.aiv-cdn.net/iad-nitro/live/clients/dash/enc/f60kqesunw/out/v1/a435ed7a00f947deb4369b46d8f2fb70/cenc.mpd",
    keyId:"1779c27b9d077a3ba0c9cc1bb9a94b9f",
    key: "cc5cf3b7928fb9e0a1ee6a8b566f0a8e",
    logo: "https://s10019.cdn.ncms.io/wp-content/uploads/2024/01/Willow-is-on-DIRECTV.png",
  },
  "A Sports HD ": {
    file: "https://webott.viatv.com.np/v0t1/ASportsHd/playlist.m3u8",
    logo: "https://upload.wikimedia.org/wikipedia/en/0/0c/A_Sports_Logo.png",
  },
  "FIFA plus": {
    file: "https://a62dad94.wurl.com/master/f36d25e7e52f1ba8d7e56eb859c636563214f541/UmFrdXRlblRWLWV1X0ZJRkFQbHVzRW5nbGlzaF9ITFM/playlist.m3u8",
    logo: "https://brandlogos.net/wp-content/uploads/2022/10/fifa-logo_brandlogos.net_pdjxs-512x512.png",
  },
  "Star Sports 1": {
    file: "https://starsportshindiii.pages.dev/720p.m3u8",
    logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Star_Sports_1_HD.png/2560px-Star_Sports_1_HD.png",
  },
  "Discovery": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Discoverychannel2/default/manifest.mpd",
    keyId: "b70a8cf9450c4d6484b4ac4d3c6761c0",
    key: "0908be844260409cbac180bf0181da40",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/UyI5ljKM.png",
  },
  "Zee Cinema": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Zeecinema/default/manifest.mpd",
    keyId: "43513b13f4b542e39c9265921dfc1726",
    key: "b0b2678bcd274c37b888a6c987d502ed",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/qss9gFuH.png",
  },
  "Discovery Kids": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Discoverykids2/default/manifest.mpd",
    keyId: "601f58d4b7094d2baf78c85d1d9cb6c9",
    key: "609e0cc03198455fa36fd2cc3e7f940d",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/RzedYhFG.png",
  },
  "Zee Bangala Cinema": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Zeebanglacinema/default/manifest.mpd",
    keyId:"fbbfd9ce4bbe4d818b16df7dfe89f05b",
    key: "1e96d0f88ef740e982d6f6105721c8bc",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/gLSSl4nG.png",
  },
  "Discovery Science": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Discoveryscience2/default/manifest.mpd",
    keyId:"5458f45efedb4d6f8aa6ac76c85b621b",
    key: "dbf8a0a306a64525ba3012fd225370c0",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/vIA7TExn.png",
  },
  "Discovery Turbo": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Discoveryturbo2/default/manifest.mpd",
    keyId:"c011525969e44b99a86059dbb3cdf4e8",
    key: "6700a5d93203417b8585f7de7dd1a09b",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/6eCv1iuk.png",
  },
  "And TV": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Andtv/default/manifest.mpd",
    keyId:"26df86eeebb04d7fbc45c948f76e81fd",
    key: "5f3a23f1a73c4c96ababce5fffe7b06b",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/T1CCvaAQ.png",
  },
  "Zee TV SD": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Zeetv/default/manifest.mpd",
    keyId:"ed068cf84f0640ccbc7c0e395c0a272e",
    key: "bb722190f2bb446391020411a7d0828b",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/yHNSuG1V.png",
  },
  "Zee Bollywood": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Zeebollywood/default/manifest.mpd",
    keyId:"e61523260c614746b25b9a5523fe9a39",
    key: "72ddbf37f76f49acbb8e140e7279e7a1",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/EqDlflgi.png",
  },
  "Zee Business": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Zeebusiness/default/manifest.mpd",
    keyId:"bef87892e58c446d893b16a848703b70",
    key: "51959fcbc8fe4091b570ba254bf749ae",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/vExrDK9r.png",
  },
  "TLC": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Tlc2/default/manifest.mpd",
    keyId:"e48e7373d6be47ecab83a20849f6823e",
    key: "513ce07a2ee24ffdbe667eff5a9d46a8",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/FOvFsIgt.png",
  },
  "Zoom": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Zoom2/default/manifest.mpd",
    keyId:"86edec9e3b7d4042a4d4a1ca14f847ee",
    key: "9def4315f0004019a3705bcb3cf30ca3",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/jLvKrs62.png",
  },
  "Zee Anmol": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Zeeanmol/default/manifest.mpd",
    keyId:"4023613457774cbeb71a62c339970e63",
    key: "1c3e9fce5f014542be9cd1f749181204",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/QjKdER9Z.png",
  },
  "Zee Anoml Cinema": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Zeeanmolcinema/default/manifest.mpd",
    keyId:"812411cba8bc42c79eb2b19cd78ad3f3",
    key: "468a0b8d3d5d42d8a5c41bb875390a74",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/diYkUOnX.png",
  },
  "Zing": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Zing/default/manifest.mpd",
    keyId:"f0fb14eebe474a6ab74c8301d55a7224",
    key: "f9f8b2e30704458b8db844a285ce32be",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/Nyi83z1G.png",
  },
  "And Pictures": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Andpictures/default/manifest.mpd",
    keyId:"8dea532cabfe4f71ba20f62310e7949f",
    key: "7a214a974e4f4d1d9bb66364d5f0cb92",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/HivVrdof.png",
  },
  "MTV Beats": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Mtvbeats2/default/manifest.mpd",
    keyId:"2a457a6a58184234ba9bfa6916ce8013",
    key: "ef3dd80894774430a33ecbc9108e91d7",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/MJZdklJi.png",
  },
  "Shorts Tv Active": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Shortstv2/default/manifest.mpd",
    keyId:"b994480f788d41ddbc805862ac469416",
    key: "78a6a0fc1758483595da7113e58e4467",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/lcMc75Xr.png",  },
  "Korean Drama Active": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Koreandramas2/default/manifest.mpd",
    keyId:"ed197e7253c04946903f03bad9afac91",
    key: "99ebb8683ea74b70a9fda1cbdc2cc1b4",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/BNu8WvFw.png",
  },
  "NDTV India": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Ndtvindia2/default/manifest.mpd",
    keyId:"d78c01625c3f4ed98912609799298544",
    key: "b91bb882f9624872ada6125006fe5c73",
    logo: "https://d388d59m61mm0v.cloudfront.net/optimized/content/common/logos/channel/logos/iqfloc.png",

  },
  "Investigation Discovery": {
    file: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Investigationdiscovery2/default/manifest.mpd",
    keyId: "2828ea6f6a984505b0454da0c03f68b9",
    key: "5d3b7195086544c2807aa8c1544e7379",
    logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/mHhlDCiL.png",
  },
  // Example of unencrypted channel
  "Sananda TV": {
    file: "http://main.light-ott.net/play/live.php?mac=00:1A:79:3D:1E:30&stream=908674&extension=m3u8",
    logo: "https://www.jagobd.com/wp-content/uploads/2024/10/sananda.jpg",
  }
};
let playerInstance = null;
let currentChannel = null;

function loadList(list) {
  let html = "";
  
  if (list.length === 0) {
    html = `<div class='no-results'>No channels found matching your search</div>`;
  } else {
    list.forEach((name) => {
      const isActive = currentChannel === name ? 'active' : '';
      html += `
        <div class='channel ${isActive}' onclick="playChannel('${name}')">
          <img src='${channels[name].logo}' alt='${name} logo' />
          <div class='channel-info'>
            <div class='channel-name'>${name}</div>
            <div class='channel-status'><span class='status-indicator'></span> Live</div>
          </div>
        </div>
      `;
    });
  }
  
  document.getElementById("channelList").innerHTML = html;
}

// Initial load
loadList(Object.keys(channels));

function searchChannels() {
  let searchTerm = document.getElementById("searchBox").value.toLowerCase();
  let filtered = Object.keys(channels).filter((name) => 
    name.toLowerCase().includes(searchTerm)
  );
  loadList(filtered);
}

function playChannel(name) {
  let ch = channels[name];
  
  // Update UI to show active channel
  currentChannel = name;
  loadList(Object.keys(channels).filter(n => 
    n.toLowerCase().includes(document.getElementById("searchBox").value.toLowerCase())
  ));
  
  // Show player and update now playing text
  document.getElementById("playerBox").style.display = "block";
  document.getElementById("nowPlaying").textContent = `Now Playing: ${name}`;
  
  // Destroy existing player instance if exists
  if (playerInstance) {
    playerInstance.destroy();
  }
  
  // Check if the channel has DRM keys
  const hasKeys = ch.keyId && ch.key;
  
  // Create player configuration
  const playerConfig = {
    source: ch.file,
    autoPlay: true,
    parentId: "#player",
    height: '100%',
    width: '100%'
  };
  
  // Add DRM configuration only if keys are available
  if (hasKeys) {
    playerConfig.mimeType = "application/dash+xml";
    playerConfig.plugins = [DashShakaPlayback];
    playerConfig.shakaConfiguration = { 
      drm: { 
        clearKeys: { 
          [ch.keyId]: ch.key 
        } 
      } 
    };
  }
  
  // Create new player instance
  playerInstance = new Clappr.Player(playerConfig);
  
  // Scroll to top smoothly
  window.scrollTo({ top: 0, behavior: "smooth" });
}

// Close player functionality
document.getElementById('closePlayer').addEventListener('click', function() {
  document.getElementById("playerBox").style.display = "none";
  if (playerInstance) {
    playerInstance.destroy();
    playerInstance = null;
  }
  currentChannel = null;
  loadList(Object.keys(channels).filter(n => 
    n.toLowerCase().includes(document.getElementById("searchBox").value.toLowerCase())
  ));
});

// Add keyboard support for search
document.getElementById('searchBox').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    searchChannels();
  }
});
